(()=>{"use strict";var t={429:()=>{Object.assign(Element.prototype,{attr:function(t,e){const n=this;return void 0===e?n.getAttribute(t):"string"==typeof e?(n.setAttribute(t,e),n):(n.removeAttribute(t),n)},addClass:function(...t){const e=this;return t.forEach((t=>e.classList.add(t))),e},removeClass:function(...t){const e=this;return t.forEach((t=>e.classList.remove(t))),e},toggleClass:function(...t){const e=this;return t.forEach((t=>e.classList.toggle(t))),e},hasClass:function(t){return this.classList.contains(t)}}),Object.assign(HTMLElement.prototype,{top:function(){let t=this.offsetTop,e=this.offsetParent;for(;e;)t+=e.offsetTop,e=e.offsetParent;return t},left:function(){let t=this.offsetLeft,e=this.offsetParent;for(;e;)t+=e.offsetLeft,e=e.offsetParent;return t},css:function(t,e){const n=this;if("string"==typeof t){if(void 0===e)return getComputedStyle(n).getPropertyValue(t);n.style.setProperty(t,e)}else for(const e in t){const i=t[e];n.style.setProperty(e,i)}return n},wrap:function(t){const e=this,n=e.parentElement;return n.insertBefore(t,e),n.removeChild(e),t.appendChild(e),e}}),Object.assign(Array.prototype,{peek:function(){const t=this;if(0!==t.length)return t[t.length-1]}})}},e={};function n(i){var s=e[i];if(void 0!==s)return s.exports;var o=e[i]={exports:{}};return t[i](o,o.exports,n),o.exports}(()=>{n(429);const t={timingFunctions:{linear:(t,e,n)=>e+t*(n-e),easeIn:(t,e,n)=>e+t*t*(n-e),easeOut:(t,e,n)=>e+(2*t-t*t)*(n-e)},randomInt:(t,e)=>Math.floor(Math.random()*e+t),scrollTo(t,e=!0){const n="number"==typeof t?t:t.top();window.scrollTo({top:n,behavior:e?"smooth":void 0})},hexToRGBA:(t,e)=>`rgba(${parseInt("0x"+t.slice(1,3))}, ${parseInt("0x"+t.slice(3,5))}, ${parseInt("0x"+t.slice(5,7))}, ${e})`,RGBToRGBA(t,e){const n=t.match(/rgba?\(\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*(,\s*[\d.]+\s*)?\)/i);return`rgba(${n[1]}, ${n[2]}, ${n[3]}, ${e})`},setColorAlpha(t,e){return t.startsWith("#")?this.hexToRGBA(t,e):this.RGBToRGBA(t,e)}};function e(t,e){return(e||document).querySelector(t)}e.assert=function(t,n){const i=e(t,n);if(!i)throw new Error("can not find element matching ("+t+") in "+(n||document));return i},e.all=function(t,e){return(e||document).querySelectorAll(t)},e.each=function(t,n,i){e.all(t,i).forEach(n)},e.create=function(t,e){const n=document.createElement(t);if(e)for(const t in e)n.attr(t,e[t]);return n};const i={info(...t){},warning(...t){},error(...t){0===t.length&&t.push(""),"string"!=typeof t[0]&&t.unshift(""),console.log("%cERROR%c %s","color:red;","",...t)}};const s=new Set;function o(t){const n=t.lastIndexOf(".");switch(t.substring(n+1)){case"js":return function(t){const n=e.create("script",{src:t,type:"text/javascript",charset:"UTF-8"});return n.async=!1,document.body.insertAdjacentElement("beforeend",n),new Promise((t=>{n.addEventListener("load",(()=>t()))}))}(t);case"css":return function(t){const n=e.create("link",{rel:"stylesheet",type:"text/css",href:t});return document.body.insertAdjacentElement("beforeend",n),new Promise((t=>{n.addEventListener("load",(()=>t()))}))}(t);default:return Promise.reject("unknown asset")}}const a={loadAssetAsync(t){return e=this,n=void 0,r=function*(){s.has(t)||(yield o(t),i.info("load asset: "+t),s.add(t))},new((a=void 0)||(a=Promise))((function(t,i){function s(t){try{c(r.next(t))}catch(t){i(t)}}function o(t){try{c(r.throw(t))}catch(t){i(t)}}function c(e){var n;e.done?t(e.value):(n=e.value,n instanceof a?n:new a((function(t){t(n)}))).then(s,o)}c((r=r.apply(e,n||[])).next())}));var e,n,a,r},loadAssetsAsync(t){const e=[];for(const n of t){if(s.has(n))continue;const t=o(n).then((()=>{i.info("load asset: "+n),s.add(n)}));e.push(t)}return Promise.allSettled(e)}},r=function(t,e){try{if(void 0===e)return localStorage.getItem(t);"string"==typeof e?(localStorage.setItem(t,e),i.info("save user pref '%s': '%s'",t,e)):(localStorage.removeItem(t),i.info("remove user pref '%s'",t))}catch(t){void 0===e?i.error("can not get user pref",t):"string"==typeof e?i.error("can not set user pref",t):i.error("can not remove user pref",t)}},c="anemo-color-scheme",l="(prefers-color-scheme: dark)";let d=!0,u=!0,h="light";const p=[];function m(t){h=t,document.documentElement.attr("data-color-scheme",t),p.forEach((e=>e(t))),i.info("color scheme -> %s",t)}function f(t){return"dark"===t||"light"===t}function g(){return window.matchMedia(l).matches?"dark":"light"}const v={get currentScheme(){return h},set currentScheme(t){d?h!==t&&(m(t),t===g()?(r(c,null),u=!0):(r(c,t),u=!1)):i.error("can not change color scheme because it is not changeable")},initialize(){let t=null,n=!0,i=!0;const s=function(){const t=document.documentElement.attr("data-default-color-scheme");return f(t)?t:null}();if(s)t=s,n=!1,i=!1;else{const e=function(){const t=r(c);return f(t)?t:null}();f(e)&&(t=e,i=!1)}var o;d=n,u=i,m(null!=t?t:g()),o=this,d&&window.matchMedia(l).addEventListener("change",(t=>{u&&(o.currentScheme=t.matches?"dark":"light")})),function(t){const n=e.assert("#color-scheme-btn");d?n.addEventListener("click",(()=>t.change())):n.css("display","none")}(this)},change(){switch(this.currentScheme){case"light":this.currentScheme="dark";break;case"dark":this.currentScheme="light"}},registerCallback(t){p.push(t)}};var y=function(t,e,n,i){return new(n||(n=Promise))((function(s,o){function a(t){try{c(i.next(t))}catch(t){o(t)}}function r(t){try{c(i.throw(t))}catch(t){o(t)}}function c(t){var e;t.done?s(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(a,r)}c((i=i.apply(t,e||[])).next())}))};const w=new Map,b=[],_={registerComponentsAsync(...t){return y(this,void 0,void 0,(function*(){for(const e of t){let t;try{t=e.initialize(),"boolean"!=typeof t&&(t=yield t)}catch(t){i.error(`failed to initialize and register component '${e.name}'!`,t);continue}t?(i.info(`register component '${e.name}'.`),b.push(e)):i.warning(`component '${e.name}' is not registered because it is disabled!`)}}))},refreshAllComponentsAsync(){return y(this,void 0,void 0,(function*(){for(const t of b)if(t.refresh)try{const e=t.refresh();e&&(yield e),i.info(`refresh component '${t.name}'.`)}catch(e){i.error(`failed to refresh component '${t.name}'!`,e)}}))},cleanupAllComponents(){for(const t of b)if(t.cleanup)try{t.cleanup(),i.info(`cleanup component '${t.name}'.`)}catch(e){i.error(`failed to cleanup component '${t.name}'!`,e)}},registerAPI(t,e,n){const s=n.bind(t);w.has(e)?i.warning(`component '${t.name}' overrides api '${e}'!`):i.info(`component '${t.name}' registers api '${e}'.`),w.set(e,s)},invokeAPI(t,...e){const n=w.get(t);return n?{success:!0,value:n(...e)}:{success:!1}}};const x={},E={get siteConfig(){return x},get pageAssetConfig(){return window.PAGE_ASSETS},initializeAsync(){return t=this,e=void 0,i=function*(){const t=yield fetch("/site-config.json");Object.assign(x,yield t.json())},new((n=void 0)||(n=Promise))((function(s,o){function a(t){try{c(i.next(t))}catch(t){o(t)}}function r(t){try{c(i.throw(t))}catch(t){o(t)}}function c(t){var e;t.done?s(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(a,r)}c((i=i.apply(t,e||[])).next())}));var t,e,n,i}},C="#loading-box p",k=[102,102,102],M=[[255,102,64],[0,192,255],[51,215,160],[204,128,255],[155,229,61],[122,242,242],[255,176,13]];let L,A,T,P,S,$,I,B,j,O,z,F,H,R,q;function D(n){if(1!==S){if(P||(A?.001*(n-A)>=5&&(P=!0,e.assert(C).addClass("active")):A=n),T){const e=.001*(n-T),i=Math.min(10*e,.5);S=t.timingFunctions.linear(i,S,$)}else S=0;if(S>=.99&&(S=1),T=n,R&&!document.body.hasClass("loaded")){const t=2*document.body.clientWidth,e=2*document.body.clientHeight,n=Math.max(.25*t,528),s=n*q.height/q.width,o=.5*(t-n),a=.5*(e-s);F===t&&H===e&&z||(j.width=t,j.height=e,I.width=t,I.height=e,F=t,H=e,O.drawImage(q,o,a,n,s),z=O.getImageData(o,a,n,s),i.warning("resize loading box canvas."));const r=4*n,c=r*S,l=z.data;let d,u;"light"===v.currentScheme?(d=!0,u=[255,255,255]):(d=!1,u=[102,102,102]);for(let t=0;t<r;t+=4)for(let e=0;e<s;e++){const n=t+e*r;let i;if(t<c)if(d)i=k;else{const e=Math.floor(t*M.length/r);i=M[e]}else i=u;l[n+3]>0&&(l[n]=i[0],l[n+1]=i[1],l[n+2]=i[2])}B.putImageData(z,o,a)}requestAnimationFrame(D)}else document.body.attr("loaded","")}const W={initialize(t,n){L=t,L&&(P=!1,S=1,$=1,I=e.assert("#loading-box canvas"),B=I.getContext("2d"),j=document.createElement("canvas"),O=j.getContext("2d",{willReadFrequently:!0}),R=!1,q=new Image,q.onload=()=>R=!0,q.onerror=()=>i.error("download genshin loading image failed, because an error occurred."),q.onabort=()=>i.error("download genshin loading image failed, because download is aborted."),q.src=n,e.assert("#loading-box .loading-bg").addEventListener("click",(()=>{P&&(document.body.attr("loaded",""),i.warning("loading box is forced to be hidden."))})))},display(t,n){L&&($=t,i.info(n),S<1||(P&&e.assert(C).removeClass("active"),A=void 0,T=void 0,P=!1,S=0,B.clearRect(0,0,I.width,I.height),requestAnimationFrame(D),document.body.attr("loaded",null)))}};let N=null;const G={get pjax(){return N},initialize(t,e,n,i){t&&(N=new Pjax(Object.assign({},e)),n&&window.addEventListener("pjax:send",n),i&&window.addEventListener("pjax:success",i)),null==i||i()}};function U(){const t=e("header.banner");if(!t)return;const n=parseInt(t.attr("banner-height")||"100")/100,i=Math.ceil(window.innerHeight*n);t.css("height",i+"px")}const V={name:"banner-beautifier",initialize:()=>(window.addEventListener("resize",(()=>U())),!0),refresh(){U()}};var Y=function(t,e,n,i){return new(n||(n=Promise))((function(s,o){function a(t){try{c(i.next(t))}catch(t){o(t)}}function r(t){try{c(i.throw(t))}catch(t){o(t)}}function c(t){var e;t.done?s(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(a,r)}c((i=i.apply(t,e||[])).next())}))};const X=[["music.163.com.*song.*id=(\\d+)","netease","song"],["music.163.com.*album.*id=(\\d+)","netease","album"],["music.163.com.*artist.*id=(\\d+)","netease","artist"],["music.163.com.*playlist.*id=(\\d+)","netease","playlist"],["music.163.com.*discover/toplist.*id=(\\d+)","netease","playlist"],["y.qq.com.*song/(\\w+).html","tencent","song"],["y.qq.com.*album/(\\w+).html","tencent","album"],["y.qq.com.*singer/(\\w+).html","tencent","artist"],["y.qq.com.*playsquare/(\\w+).html","tencent","playlist"],["y.qq.com.*playlist/(\\w+).html","tencent","playlist"],["xiami.com.*song/(\\w+)","xiami","song"],["xiami.com.*album/(\\w+)","xiami","album"],["xiami.com.*artist/(\\w+)","xiami","artist"],["xiami.com.*collect/(\\w+)","xiami","playlist"]],J={parseLink(t){for(const e of X){const n=new RegExp(e[0]).exec(t);if(n)return{server:e[1],type:e[2],id:n[1]}}return null},requestAPIAsync(t){return Y(this,void 0,void 0,(function*(){const e=t.map((t=>Y(this,void 0,void 0,(function*(){const e=this.parseLink(t);if(!e)return i.warning("invalid music link: "+t),[];const n=`https://api.i-meto.com/meting/api?server=${e.server}&type=${e.type}&id=${e.id}&r=${Math.random()}`,s=yield fetch(n);return yield s.json()}))));return(yield Promise.all(e)).flat(1)}))},formatTime(t){const e=Math.floor(t/3600),n=Math.floor((t-3600*e)/60),i=Math.floor(t-3600*e-60*n);return(e>0?[e,n,i]:[n,i]).map((t=>isNaN(t)?"00":t<10?"0"+t:""+t)).join(":")},autoplay(t){let e=!0;const n=()=>{e&&(e=!1,t(),document.removeEventListener("mousedown",n),document.removeEventListener("scroll",n),document.removeEventListener("touchstart",n))};return document.addEventListener("mousedown",n),document.addEventListener("scroll",n),document.addEventListener("touchstart",n),()=>{e&&(document.removeEventListener("mousedown",n),document.removeEventListener("scroll",n),document.removeEventListener("touchstart",n))}}};class K{constructor(t,n,i){this._panel=e.assert(t),this._openButton=e.assert(n),this._closeButton=e.assert(".top-layer-panel-close-btn",this._panel),this._state="closed",this.setState(),this._openButton.addEventListener("click",(()=>{var t;null===(t=null==i?void 0:i.beforeOpen)||void 0===t||t.call(i),this.openAsync().then(null==i?void 0:i.afterOpen)})),this._closeButton.addEventListener("click",(()=>{var t;null===(t=null==i?void 0:i.beforeClose)||void 0===t||t.call(i),this.closeAsync().then(null==i?void 0:i.afterClose)}))}setState(t){t&&(this._state=t),this._panel.attr("state",this._state)}resetTransition(t){const e=this._openButton.getBoundingClientRect(),n=.5*(e.left+e.right),i=.5*(e.top+e.bottom);this._panel.css({"transform-origin":`${n}px ${i}px`,"-webkit-transform-origin":`${n}px ${i}px`,"animation-duration":t/1e3+"s","-webkit-animation-duration":t/1e3+"s"})}get state(){return this._state}get panelElement(){return this._panel}get openBtnElement(){return this._openButton}get closeBtnElement(){return this._closeButton}openAsync(t=!0,e=!1){if("closed"!==this._state)return e||i.warning("can not open panel, because it is "+this._state),Promise.resolve();if(document.body.css("overflow","hidden"),t){const t=200;return this.resetTransition(t),this.setState("opening"),new Promise((e=>setTimeout((()=>{this.setState("opened"),e()}),t)))}return this.setState("opened"),Promise.resolve()}closeAsync(t=!0,e=!1){if("opened"!==this._state)return e||i.warning("can not close panel, because it is "+this._state),Promise.resolve();if(document.body.css("overflow",null),t){const t=200;return this.resetTransition(t),this.setState("closing"),new Promise((e=>setTimeout((()=>{this.setState("closed"),e()}),t)))}return this.setState("closed"),Promise.resolve()}}var Q=function(t,e,n,i){return new(n||(n=Promise))((function(s,o){function a(t){try{c(i.next(t))}catch(t){o(t)}}function r(t){try{c(i.throw(t))}catch(t){o(t)}}function c(t){var e;t.done?s(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(a,r)}c((i=i.apply(t,e||[])).next())}))};const Z="anemo-bg-music-play-mode";class tt{constructor(t){this._container=e.assert(".bg-music-lyric"),this._containerParent=this._container.parentElement,this._data=t,this._index=0,this._lines=[],this._container.innerHTML="",this._data.forEach((t=>{const e=document.createElement("p");e.textContent=t.text,t.translation&&(e.innerHTML+="<br>"+t.translation),this._container.appendChild(e),this._lines.push(e)})),this.setCurrent(0)}setCurrent(t){if(t<0||t>=this._data.length)return void i.warning(`can not set current lyric, because index(${t}) is out of range: [0, ${this._data.length})`);this._lines[this._index].attr("current",null),this._index=t,this._lines[t].attr("current","");const e=this._lines.reduce(((e,n,i)=>i>t?e:i===t?e+.8*n.offsetHeight:e+n.offsetHeight),0),n=`translateY(${.5*this._containerParent.offsetHeight-e}px)`;this._container.css({transform:n,"-webkit-transform":n})}update(t,e){if(0===this._data.length)return;if(!e&&0===this._containerParent.offsetHeight)return;const n=this._index,s=this._data,o=n<0||n>s.length-1,a=t<s[n].time,r=s[n+1]&&t>=s[n+1].time;if(e||o||a||r){for(let e=0;e<s.length;e++)if(t>=s[e].time&&(e+1>=s.length||t<s[e+1].time))return void this.setCurrent(e);this.setCurrent(0),i.warning("lyric update fallback")}}static downloadAsync(t){return Q(this,void 0,void 0,(function*(){const e=yield fetch(t);let n=yield e.text(),i=[];if(n.length>0){n=n.replace(/([^\]^\n])\[/g,((t,e)=>e+"\n["));const t=n.split("\n");for(let e=0;e<t.length;e++){const n=t[e].match(/\[(\d{2}):(\d{2})(\.(\d{2,3}))?]/g);if(!n)continue;let s,o=t[e].replace(/.*\[(\d{2}):(\d{2})(\.(\d{2,3}))?]/g,"").replace(/<(\d{2}):(\d{2})(\.(\d{2,3}))?>/g,"").replace(/^\s+|\s+$$/g,"");const a=o.lastIndexOf(" (");a>-1&&o.endsWith(")")&&(s=o.substring(a+2,o.length-1),o=o.substring(0,a));for(let t=0;t<n.length;t++){const e=/\[(\d{2}):(\d{2})(\.(\d{2,3}))?]/.exec(n[t]),a=60*parseInt(e[1])+parseInt(e[2])+(e[4]?parseInt(e[4])/(2===(e[4]+"").length?100:1e3):0);i.push({time:a,text:o,translation:s})}}}if(0===i.length)i.push({time:0,text:"This music has no lyrics now",translation:"该音乐暂无歌词"});else{i=i.filter((t=>t.text)).sort(((t,e)=>t.time-e.time));for(let t=i.length-1;t>=1;t--)i[t-1].time===i[t].time&&void 0!==i[t].translation&&i[t].translation===i[t-1].translation&&i.splice(t,1);i[0].time>0&&i.unshift({time:0,text:"..."})}return new tt(i)}))}}class et{constructor(t){this._timeCurrent=e.assert(".bg-music-time span[data=current]"),this._timeLength=e.assert(".bg-music-time span[data=length]"),this._progressBar=e.assert(".bg-music-progress"),this._progressSlider=e.assert(".bg-music-progress>div"),this._events=t,this._progress=0,this.update(0,0),this._progressBar.addEventListener("mousedown",this.startSeekingMouse.bind(this)),this._progressBar.addEventListener("touchstart",this.startSeekingTouch.bind(this),{passive:!1})}get progress(){return this._progress}update(t,e){this._progress=t,this._timeCurrent.textContent=J.formatTime(t*e),this._timeLength.textContent=J.formatTime(e),this._progressSlider.css("width",(100*t).toFixed(2)+"%")}calcSeekProgress(t){const e=this._progressBar.getBoundingClientRect(),n=(t-e.left)/e.width;return Math.min(Math.max(n,0),1)}startSeekingMouse(t){if(t.preventDefault(),!this._events.seekStart())return;const e=t=>{t.preventDefault();const e=this.calcSeekProgress(t.clientX);this._events.seeking(e)},n=t=>{t.preventDefault();const i=this.calcSeekProgress(t.clientX);this._events.seekEnd(i),document.removeEventListener("mousemove",e),document.removeEventListener("mouseup",n)};document.addEventListener("mousemove",e),document.addEventListener("mouseup",n)}startSeekingTouch(t){if(!t.cancelable)return;if(t.preventDefault(),!this._events.seekStart())return;const e=t=>{t.preventDefault();const e=this.calcSeekProgress(t.changedTouches[0].clientX);this._events.seeking(e)},n=t=>{t.preventDefault();const i=this.calcSeekProgress(t.changedTouches[0].clientX);this._events.seekEnd(i),document.removeEventListener("touchmove",e),document.removeEventListener("touchend",n)};document.addEventListener("touchmove",e,{passive:!1}),document.addEventListener("touchend",n,{passive:!1})}}class nt{constructor(t,n){this._ul=e.assert(".bg-music-playlist-item-container>ul"),this._musics=t,this._playIndex=-1,this._events=n,this._switchMusicLock=!1}updateWidgetView(){this._ul.innerHTML="",this._musics.forEach(((t,n)=>{const i=e.create("i",{class:E.siteConfig.bgMusic.playing_icon}),s=e.create("div");s.textContent=t.title;const o=e.create("div");o.textContent=t.author;const a=e.create("li");a.appendChild(i),a.appendChild(s),a.appendChild(o),a.attr("index",n.toString()),a.addEventListener("click",(()=>{const t=parseInt(a.attr("index"));this.switchToMusicAsync(t,0,!0,!1)})),this._ul.appendChild(a)}))}get musicCount(){return this._ul.childElementCount}get playIndex(){return this._playIndex}switchToMusicAsync(t,e,n,s){var o;return Q(this,void 0,void 0,(function*(){if(0!==this.musicCount)if(this._switchMusicLock)i.warning("to avoid violation, you can not switch music now");else{if((t=(t%=this.musicCount)<0?t+this.musicCount:t)!==this._playIndex)null===(o=this._ul.children[this._playIndex])||void 0===o||o.attr("current",null),this._ul.children[t].attr("current","");else if(!s)return;this._switchMusicLock=!0;{this._playIndex=t;const i=this._musics[t];yield this._events.switchMusic(i,e,n)}this._switchMusicLock=!1}}))}switchToNextMusic(e,n,i,s){let o=this._playIndex;const a="forward"===e?1:-1;if(n){const e=t.randomInt(0,this.musicCount);o=e===o?e+a:e}else o+=a;this.switchToMusicAsync(o,0,i,s)}switchToSpecificMusic(t,e,n,i){this.switchToMusicAsync(t,e,n,i)}static initializeWidget(){this._widgetRoot=e.assert(".bg-music-playlist"),e.assert("#bg-music-playlist-button").addEventListener("click",(()=>nt.showWidget())),e.assert(".bg-music-playlist-mask").addEventListener("click",(()=>nt.hideWidget()))}static showWidget(){this._widgetRoot.attr("show","")}static hideWidget(){this._widgetRoot.attr("show",null)}static downloadAsync(t,e){return Q(this,void 0,void 0,(function*(){if(0===t.length)return new nt([],e);const n=yield J.requestAPIAsync(t);return new nt(n,e)}))}}class it{constructor(){this._button=e.assert("#bg-music-play-mode-button"),this._button.addEventListener("click",(()=>this.switchPlayMode()));const t=r(Z);this._playMode=t||"loop",this.updateButton()}get playMode(){return this._playMode}switchPlayMode(){this._playMode=it.nextPlayMode(this._playMode),r(Z,this._playMode),this.updateButton()}updateButton(){this._button.attr("mode",this._playMode)}static nextPlayMode(t){switch(t){case"loop":return"loop-one";case"loop-one":return"random";case"random":return"loop"}}}class st{constructor(){this._enableTimeUpdating=!0,this._coverModeOnMobileDevice=!0,this._audio=e.assert("#bg-music-panel audio"),this._musicTitle=e.assert(".bg-music-title"),this._musicSubtitle=e.assert(".bg-music-subtitle"),this._musicDisc=e.assert(".bg-music-disc img"),this._panel=new K("#bg-music-panel","#bg-music-btn",{beforeOpen:()=>this._enableTimeUpdating=!0,afterOpen:()=>{this.isAudioLoaded()&&(this.updateProgressBar(),this.updateLyric(!0))},afterClose:()=>this._enableTimeUpdating=!1}),this._playModeController=new it,this._progressBar=new et({seekStart:()=>!!this.isAudioLoaded()&&(this._enableTimeUpdating=!1,!0),seeking:t=>{this.updateProgressBar(t),this.updateLyric(!1,t*this._audio.duration)},seekEnd:t=>{this._audio.currentTime=t*this._audio.duration,this._enableTimeUpdating=!0}}),this.initAudioEvents(),this.initCtrlButtonEvents(),this.initMobileDeviceEvents(),nt.initializeWidget()}initAudioEvents(){this._audio.addEventListener("load",(()=>{this.updateProgressBar(),this.updateLyric(!0)})),this._audio.addEventListener("timeupdate",(()=>{this._enableTimeUpdating&&(this.updateProgressBar(),this.updateLyric(!1))})),this._audio.addEventListener("ended",(()=>this.playNextMusic("forward")))}initCtrlButtonEvents(){const t=e.assert("#bg-music-play-pause-button"),n=e.assert("#bg-music-previous-button"),i=e.assert("#bg-music-next-button");t.addEventListener("click",(()=>{this._audio.paused?this.playCurrentMusic():this.pauseCurrentMusic()})),n.addEventListener("click",(()=>this.playNextMusic("backward"))),i.addEventListener("click",(()=>this.playNextMusic("forward")))}initMobileDeviceEvents(){const t=e.assert(".bg-music-cover-control"),n=e.assert(".bg-music-cover"),i=e.assert(".bg-music-info");t.addEventListener("click",(e=>{document.documentElement.clientWidth>540||e.target===t&&(this._coverModeOnMobileDevice=!this._coverModeOnMobileDevice,this._coverModeOnMobileDevice?(n.attr("mobile-active",""),i.attr("mobile-active",null)):(n.attr("mobile-active",null),i.attr("mobile-active","")))}))}isAudioLoaded(){return isFinite(this._audio.duration)}updateProgressBar(t){void 0===t&&(t=this._audio.currentTime/this._audio.duration),this._progressBar.update(t,this._audio.duration)}updateLyric(t,e){void 0===e&&(e=this._audio.currentTime),this._lyric.update(e,t)}get isPlaying(){return!this._audio.paused}get currentTime(){return this._audio.currentTime}get currentMusicIndex(){return this._playlist?this._playlist.playIndex:-1}playCurrentMusic(t){this._audio.paused?void 0!==this._playlist?0!==this._playlist.musicCount?(this._panel.panelElement.attr("playing",""),this._panel.openBtnElement.attr("playing",""),this._audio.play().then((()=>{"number"==typeof t&&(this._audio.currentTime=t)}))):i.error("can not play music because there is no music in the playlist"):i.error("can not play music because playlist has not been loaded"):i.warning("can not play music because music has been being played")}pauseCurrentMusic(){this._audio.paused?i.warning("can not pause music because music has been paused"):(this._panel.panelElement.attr("playing",null),this._panel.openBtnElement.attr("playing",null),this._audio.pause())}playNextMusic(t){void 0!==this._playlist?0!==this._playlist.musicCount?"loop-one"===this._playModeController.playMode?(this._audio.currentTime=0,this.playCurrentMusic(0)):this._playlist.switchToNextMusic(t,"random"===this._playModeController.playMode,!0,!0):i.error("can not play next music because there is no music in the playlist"):i.error("can not play next music because playlist has not been loaded")}playSpecificMusic(t,e){void 0!==this._playlist?0!==this._playlist.musicCount?this._playlist.switchToSpecificMusic(t,e,!0,!0):i.error("can not play next music because there is no music in the playlist"):i.error("can not play next music because playlist has not been loaded")}reloadMusicAsync(t){return Q(this,void 0,void 0,(function*(){this._audio.paused||this.pauseCurrentMusic(),this._lyric=yield tt.downloadAsync(t.lrc),this._musicTitle.textContent=t.title,this._musicTitle.title=t.title,this._musicSubtitle.textContent=t.author,this._musicSubtitle.title=t.author,this._musicDisc.src=t.pic,this._audio.src=t.url,this._audio.currentTime=0}))}downloadPlaylistAsync(t){return nt.downloadAsync(t,{switchMusic:(t,e,n)=>Q(this,void 0,void 0,(function*(){yield this.reloadMusicAsync(t),n&&this.playCurrentMusic(e)}))})}setPlaylist(t,e,n){if(this._playlist=t,t.updateWidgetView(),0===t.musicCount)return this._panel.openBtnElement.css("display","none"),void(this._audio.paused||this.pauseCurrentMusic());this._panel.openBtnElement.css("display",null),"boolean"==typeof e?t.switchToNextMusic("forward","random"===this._playModeController.playMode,e,!0):t.switchToSpecificMusic(e,n,!0,!0)}}let ot,at=null,rt=!1,ct=0,lt=-1,dt=!1;const ut={name:"background-music",initialize(){return Q(this,void 0,void 0,(function*(){if(!E.siteConfig.bgMusic.enable)return!1;ot=new st;const t=E.siteConfig.bgMusic.music_links,e=yield ot.downloadPlaylistAsync(t||[]);return ot.setPlaylist(e,!1),!0}))},cleanup(){at&&(at(),at=null)},refresh(){return Q(this,void 0,void 0,(function*(){const t=e(".bg-music-override");let n,s,o,a;if(!t&&rt)rt=!1,n=ct,s=lt,o=dt,a=E.siteConfig.bgMusic.music_links||[];else{if(!t)return;rt=!0,ct=ot.currentTime,lt=ot.currentMusicIndex,dt=ot.isPlaying,n=0,s=-1,o=ot.isPlaying||t.hasAttribute("autoplay"),a=JSON.parse(t.attr("playlist")||"[]"),i.info("override background music.")}const r=yield ot.downloadPlaylistAsync(a);o?at=J.autoplay((()=>{s>=0?ot.setPlaylist(r,s,n):ot.setPlaylist(r,!0),i.info("auto play background music.")})):ot.setPlaylist(r,!1)}))}},ht={name:"twikoo",initialize(){const{comments:t,twikoo:e}=E.siteConfig;return!(!t.enable||"twikoo"!==t.type||(_.registerAPI(this,"latestComments",((t,n)=>window.twikoo.getRecentComments({envId:e.envId,region:e.region,pageSize:t,includeReply:n}))),0))},refresh(){if(!e("#comments")||!window.twikoo)return;const{twikoo:t}=E.siteConfig;window.twikoo.init({envId:t.envId,region:t.region,path:t.path,el:"#twikoo",onCommentLoaded:()=>{const t=e.all("#twikoo .tk-content img:not(.tk-owo-emotion)");_.invokeAPI("imageViewer",t)}})}},pt=ht;function mt(t,e){let n=t.attr("src")||"";if(e&&e[0])if(/^re:/.test(e[0])){const t=new RegExp(e[0].replace(/^re:/,""),"gi");n=n.replace(t,e[1])}else n=n.replace(e[0],e[1]);return n}function ft(t){const{fancybox:n}=E.siteConfig;for(let i=0;i<t.length;i++){const s=t[i],o=mt(s,n.img_url_replace),a=s.attr("title")||s.attr("alt")||"unknown image",r=e.create("a",{href:o,title:a,"data-fancybox":"gallery","data-caption":a});s.wrap(r);const c=e.create("p",{class:"image-caption"});c.textContent=a,r.appendChild(c)}}const gt={name:"fancybox",initialize:function(){const{fancybox:t}=E.siteConfig;return!!t.enable&&(_.registerAPI(this,"imageViewer",(t=>{ft(t)})),!0)},refresh(){window.Fancybox&&(window.Fancybox.destroy(),window.Fancybox.bind("[data-fancybox]",E.siteConfig.fancybox.options||{}),ft(e.all(".markdown-body img:not([nofancybox])")))}},vt=gt;class yt{constructor(t){this._keyframes=t.keyframes,this._transitions=t.transitions,this._delay=t.delay,this._time=t.time}get delay(){return this._delay}get time(){return this._time}update(e,n){let i=null,s=null,o=null;for(let t=this._keyframes.length-1;t>=0;t--){const n=this._keyframes[t];if(n.progress<=e){i=n,t===this._keyframes.length-1?(s=n,e=1):(s=this._keyframes[t+1],o=this._transitions[t],e=(e-i.progress)/(s.progress-i.progress));break}}if(!i||!s)throw new Error("can not find keyframe.");if(o){const a=t.timingFunctions[o].bind(null,e);return n(i.value,s.value,a)}return s.value}}const wt=new yt({keyframes:[{progress:0,value:[0,250,550]},{progress:60,value:[0,80,480]},{progress:100,value:[0,100,500]}],transitions:["easeOut","easeOut"],delay:0,time:4}),bt=new yt({keyframes:[{progress:0,value:[-300,-250,-3]},{progress:50,value:[-180,65,-3]},{progress:100,value:[-170,60,-3]}],transitions:["easeOut","easeOut"],delay:2.5,time:1}),_t=new yt({keyframes:[{progress:0,value:[300,-250,-3]},{progress:50,value:[210,65,-3]},{progress:100,value:[200,60,-3]}],transitions:["easeOut","easeOut"],delay:2,time:1}),xt=new yt({keyframes:[{progress:0,value:[0,100,500]},{progress:100,value:[0,150,250]}],transitions:["linear"],delay:0,time:0}),Et=[{skeletonFile:"index_paimon.skeleton.json",atlasFile:"index_paimon.atlas",animation:void 0,pos:[-400,0,-3],scale:.6,animatedIn:bt},{skeletonFile:"index_yan.skeleton.json",atlasFile:"index_yan.atlas",animation:void 0,pos:[400,0,-3],scale:.6,animatedIn:_t},{skeletonFile:"index_desk.skeleton.json",atlasFile:"index_desk.atlas",animation:"animation",pos:[-13,40,-2],scale:.6},{skeletonFile:"index_light.skeleton.json",atlasFile:"index_light.atlas",animation:"animation",pos:[0,-150,-1],scale:.6}],Ct="https://gcore.jsdelivr.net/gh/Jin-Yuhan/WebAssetStorage@latest/genshin_index_spine/",kt=["01惊讶","02干劲","03思考","04烦恼","05大悟"],Mt=[],Lt=[],At=[];let Tt,Pt,St,$t,It,Bt,jt,Ot=0,zt=!1,Ft=!1;function Ht(t,e,n){return[0,0,0].map(((i,s)=>n(t[s],e[s])))}function Rt(){if(!zt)return;const t=Date.now()/1e3;if(Bt){const e=t-Bt;Ot+=e,Bt=t,function(){const t=window.innerWidth,e=window.innerHeight;$t.width===t&&$t.height===e||($t.width=t,$t.height=e),Pt.aspect=t/e,Pt.updateProjectionMatrix(),St.setSize(t,e)}(),At.forEach((t=>{if(t.finish)return;const e=Ot-t.animation.delay,n=100*Math.max(Math.min(e/t.animation.time,1),0),i=t.animation.update(n,Ht);t.obj.position.set(...i),100===n&&(t.finish=!0)})),At.every((t=>t.finish))?document.body.attr("index-banner-lock",null):document.body.attr("index-banner-lock",""),Mt.forEach((t=>t.update(e))),St.render(Tt,Pt)}else Bt=t;requestAnimationFrame(Rt)}function qt(){const t=window.scrollY||document.documentElement.scrollTop,n=e.assert("header"),i=n.clientHeight<=0?1:Math.max(0,t-n.top())/n.clientHeight,s=xt.update(100*i,Ht);Pt.position.set(...s)}function Dt(t){const e=It.require(t.atlasFile),n=new spine.AtlasAttachmentLoader(e),i=new spine.SkeletonJson(n);i.scale=t.scale;const s=i.readSkeletonData(It.require(t.skeletonFile)),o=new spine.SkeletonMesh(s,(t=>{t.depthTest=!0,t.depthWrite=!0,t.alphaTest=.001}));t.animation?o.state.setAnimation(0,t.animation,!0):Lt.push(o),o.position.set(...t.pos),Mt.push(o);const a=new THREE.Mesh;a.add(o),Tt.add(a),t.animatedIn&&At.push({obj:o,animation:t.animatedIn,finish:!1})}let Wt="",Nt=!1,Gt=null,Ut=null,Vt=null;const Yt="ended",Xt="show",Jt="open",Kt="panel";let Qt,Zt,te,ee,ne=!1;function ie(){Qt.attr(Xt,null),ee.removeClass(Jt),ne=!1}const se={name:"sidebar",initialize(){Qt=e.assert(".sidebar"),Zt=e.assert(".sidebar-switches"),te=e.assert(".sidebar-panels"),ee=e.assert(".sidebar-toggler"),ee.addEventListener("click",(()=>{ne?ie():(Qt.attr(Xt,""),ee.addClass(Jt),ne=!0)}));const t=Zt.children;for(let e=0;e<t.length;e++){const n=t[e].attr("target-panel");t[e].addEventListener("click",(()=>{te.attr(Kt,n)}))}return e.assert(".sidebar-mask").addEventListener("click",(()=>ie())),!0},refresh(){e(".toc",te)?(Zt.css("display",null),te.attr(Kt,"toc")):(Zt.css("display","none"),te.attr(Kt,"overview")),ie()}},oe=".toc-body",ae="tocbot-active-link",re="is-active-li",ce="tocbot-is-collapsed",le="tocbot-is-collapsible";function de(t){return parseInt(t.tagName.substring(1))}function ue(t,n){const i=e.create("ol",{class:"tocbot-list"});return t.appendChild(i),n&&i.addClass(le,ce),i}function he(t,n){const i=e.create("a",{href:"#"+n.id,class:"tocbot-link"});n.childNodes.forEach(((t,e)=>{if(e>0){const e=t.cloneNode(!0);i.appendChild(e)}}));const s=e.create("li",{class:"toc-list-item"});return s.appendChild(i),t.appendChild(s),s}let pe=null;const me=[{name:"scroll-down-tip",initialize:()=>!0,refresh:function(){var n;null===(n=e(".scroll-down-tip"))||void 0===n||n.addEventListener("click",(function(){const n=e("#page");n&&t.scrollTo(n)}))}},{name:"tocbot",initialize:()=>!0,cleanup(){pe&&(window.removeEventListener("scroll",pe),pe=null)},refresh(){const n=e(oe);if(!n)return;const s=e(".markdown-body");if(!s)return void i.warning("can not build toc because there is no content");const o=Array.from(e.all("h1,h2,h3,h4,h5,h6",s)).filter((t=>t.childNodes.length>1)),a=function(t,e){var n,i;if(0===t.length)return[];const s=[],o=[0,-1,-1,-1,-1,-1,-1],a=[];s[0]={item:e,list:ue(e,!1)};for(let e=1;e<=t.length;e++){const r=t[e-1],c=de(r),l=Math.max(...o.slice(0,c)),d=null!==(n=(i=s[l]).list)&&void 0!==n?n:i.list=ue(s[l].item,!0);s[e]={item:he(d,r)},o[c]=e,a.push(s[e].item.children[0])}return a}(o,n);a.forEach((n=>n.addEventListener("click",(i=>{i.preventDefault(),t.scrollTo(e.assert(n.attr("href")))}))));let r=-1;pe=()=>{const t=window.scrollY||document.documentElement.scrollTop;!function(t,n){const i=t.clientHeight<=0?1:Math.max(0,n-t.top())/t.clientHeight,s=Math.min(100,Math.floor(100*i));e.assert(".toc-header").attr("progress-percentage",s+"%")}(s,t),a.length>0&&(r=function(t,e,n,i){var s,o;let a=-1;for(let e=t.length-1;e>=0;--e)if(i>t[e].top()-120){a=e;break}if(n!==a){if(n>=0&&n<t.length){const t=e[n];let i=t.parentElement;for(t.removeClass(ae),i.removeClass(re),null===(s=t.nextElementSibling)||void 0===s||s.addClass(ce);!i.matches(oe);)i.matches("."+le)&&i.addClass(ce),i=i.parentElement}if(i>0&&a>=0&&a<t.length){const t=e[a];let n=t.parentElement;for(t.addClass(ae),n.addClass(re),null===(o=t.nextElementSibling)||void 0===o||o.removeClass(ce);!n.matches(oe);)n.matches("."+le)&&n.removeClass(ce),n=n.parentElement}}return a}(o,a,r,t))},window.addEventListener("scroll",pe),pe(),e.assert(".toc").css("visibility","visible")}},se,{name:"markdown-beautifier",initialize:()=>!0,refresh(){const n=e(".markdown-body");var s;n?(s=n,e.each("h1, h2",(t=>{const n=e.create("span");Array.from(t.childNodes).forEach(((t,e)=>{e>0&&n.appendChild(t)})),t.appendChild(n)}),s),function(t){e.each("div.tab",(n=>{const i=n.attr("tab-id"),s=n.attr("tab-name");if(!i||!s)return;let o,a,r=e("#"+i,t);r?(r.appendChild(n),o=e.assert(".tabs-nav",r),a=!1):(r=e.create("div",{id:i,class:"tabs"}),n.wrap(r),o=e.create("ul",{class:"tabs-nav"}),r.insertBefore(o,n),a=!0);const c=e.create("li");c.textContent=s,o.appendChild(c),a&&(n.attr("active",""),c.attr("active","")),c.addEventListener("click",(()=>{e.all("[active]",r).forEach((t=>t.attr("active",null))),e.assert(`.tab[tab-name="${s}"]`,r).attr("active",""),c.attr("active","")}))}),t)}(n),function(n){const i="show-btn-open";function s(t,e,n,s){void 0===s&&(s=!e.hasClass(i)),s?(e.addClass(i),t.attr("style",null)):(e.removeClass(i),t.attr("style",`height:${n}px;overflow:hidden;`))}e.each("pre",(t=>{var n;const i=function(t){const e=t.css("background-color").replace(/rgba*\(/,"").replace(")","").split(",");return.213*parseFloat(e[0])+.715*parseFloat(e[1])+.072*parseFloat(e[2])>127.5?"tools-dark":"tools-light"}(t);let s,o;if(!(null===(n=t.attr("class"))||void 0===n?void 0:n.includes("language-")))return;s=e(".caption",t),o=s?s.textContent:t.attr("data-language");const a=e.create("div",{class:"code-wrapper"});t.wrap(a);const r=function(t,e,n){let i=`<div class="highlight-tools ${t}">`;return i+=`<span class="lang">${e}</span>`,i+='<span class="copy-btn" data-clipboard-snippet>COPY</span>',i+="</div>",i}(i,o||"unknown");a.insertAdjacentHTML("beforeend",r),null==s||s.remove()}),n),function(){const i=E.siteConfig.code;if(!i.fold.enable)return;const o=i.fold.maxHeight,a=i.fold.downArrowIcon;e.each("pre[class*=language-]",(n=>{if(n.clientHeight<=o)return;const i=n.css("background-color"),r=t.setColorAlpha(i,0),c=e.create("div",{class:"show-btn",style:`background-image: linear-gradient(to bottom, ${r} 0, ${i} 90%);`});c.insertAdjacentHTML("beforeend",`<i class="${a}"></i>`),c.addEventListener("click",(()=>s(n,c,o))),n.parentElement.appendChild(c),s(n,c,o,!1)}),n)}()}(n)):i.warning("no markdown.")}},{name:"pagination",initialize:()=>!0,refresh(){const t=function(){const t=e("#pagination");if(!t||1!==t.childElementCount||t.hasAttribute(Yt))return;const n=t.children[0],s={container:t,trigger:n},o=["current","total","format","selector"];for(let t=0;t<o.length;t++){const e=o[t],a=n.attr(e);if(!a)return void i.error(`the pagination info lacks attribute '${e}'!`);s[e]=t<2?parseInt(a):a,n.attr(e,null)}return s}();if(!t)return void i.info("no pagination.");const n=()=>{return s=this,o=void 0,r=function*(){var s;t.container.attr("loading",""),t.current++;const o=t.format.replace("%d",t.current.toString()),a=yield fetch(o),r=yield a.text(),c=(new DOMParser).parseFromString(r,"text/html"),l=e.assert(t.selector),d=e.assert(t.selector,c);null===(s=G.pjax)||void 0===s||s.refresh(d),Array.from(d.childNodes).forEach((t=>{l.appendChild(t)})),t.current===t.total&&(t.container.attr(Yt,""),t.trigger.removeEventListener("click",n)),i.info(`pagination: ${t.current-1} -> ${t.current}.`),t.container.attr("loading",null)},new((a=void 0)||(a=Promise))((function(t,e){function n(t){try{c(r.next(t))}catch(t){e(t)}}function i(t){try{c(r.throw(t))}catch(t){e(t)}}function c(e){var s;e.done?t(e.value):(s=e.value,s instanceof a?s:new a((function(t){t(s)}))).then(n,i)}c((r=r.apply(s,o||[])).next())}));var s,o,a,r};t.trigger.addEventListener("click",n)}},{name:"local-search",initialize:function(){return Gt=e("div.search-div>input"),Gt?(Ut=e("div.search-result-list"),Ut?(Wt=Ut.innerHTML,Vt=new K("#search-panel","#search-btn",{afterOpen:()=>{Nt?Gt.focus():function(t){var n,s,o,a;n=this,s=void 0,a=function*(){Gt.disabled=!0;const t=yield fetch("/local-search.xml"),n=yield t.text(),s=(new DOMParser).parseFromString(n,"text/xml"),o=Array.from(e.all("entry",s)).map((t=>{var n,i,s;return{title:((null===(n=e("title",t))||void 0===n?void 0:n.textContent)||"Untitled").trim(),content:((null===(i=e("content",t))||void 0===i?void 0:i.textContent)||"").trim().replace(/<[^>]+>/g,""),url:(null===(s=e("url",t))||void 0===s?void 0:s.textContent)||""}}));Gt.addEventListener("input",(()=>{const t=Gt.value.trim().toLowerCase();let e="";if(t.length>0){let n=t.split(" ").filter((t=>t.length>0));n=Array.from(new Set(n)),i.info("keyword list:",n);const s=n.map((t=>t.replace(/[()[\]{}$^|?+*.\\]/gi,"\\$&"))),a=new RegExp(`(${s.join("|")})`,"gi");i.info("validated keyword list:",s),o.forEach((t=>{const i=t.title.toLowerCase(),s=t.content.toLowerCase();let o=!0;const r=[];if(s.length>0)for(const t of n){const e=i.indexOf(t),n=s.indexOf(t);if(e<0&&n<0){o=!1;break}n>=0&&r.push(n)}else o=!1;if(!o)return;let c,l="...... ";0===r.length?c=[[0,Math.min(100,t.content.length)]]:(r.sort(((t,e)=>t-e)),c=r.reduce(((e,n)=>{const i=Math.max(n-20,0),s=Math.min(i+100,t.content.length);if(e.length>0){const t=e[e.length-1];if(t[1]>=i)return t[1]=s,e}return e.push([i,s]),e}),[]));for(const e of c)l+=t.content.substring(e[0],e[1]).replace(a,'<span class="search-word">$&</span>'),l+=" ...... ";const d=t.title.replace(a,'<span class="search-word">$&</span>');e+=`<a href="${t.url}" class="search-result">`,e+=`<span>${d}</span>`,e+=`<p>${l}</p>`,e+="</a>"}))}0===e.length?(e=Wt,Gt.removeClass("valid"),t.length>0&&Gt.addClass("invalid")):Gt.addClass("valid").removeClass("invalid"),Ut.innerHTML=e})),Nt=!0,Gt.disabled=!1,Gt.focus()},new((o=void 0)||(o=Promise))((function(t,e){function i(t){try{c(a.next(t))}catch(t){e(t)}}function r(t){try{c(a.throw(t))}catch(t){e(t)}}function c(e){var n;e.done?t(e.value):(n=e.value,n instanceof o?n:new o((function(t){t(n)}))).then(i,r)}c((a=a.apply(n,s||[])).next())}))}()},beforeClose:()=>Gt.blur(),afterClose:()=>(Gt.value="",Gt.removeClass("invalid").removeClass("valid"),void(Ut.innerHTML=Wt))}),!0):(i.error("can not find div.search-result-list"),!1)):(i.error("can not find div.search-div>input"),!1)},refresh:function(){Vt.closeAsync(!1,!0)}},ut,vt,{name:"mermaid",initialize:()=>!1,refresh(){window.mermaid&&e(".mermaid")?window.mermaid.initialize(E.siteConfig.mermaid.options):i.warning("no mermaid.")}},pt,V,{name:"genshin-banner",initialize:()=>E.siteConfig.index.special_banner.enable,cleanup(){zt&&(zt=!1,Bt=void 0,Ot=0,At.forEach((t=>t.finish=!1)),$t.remove(),e.assert(".banner-mask").css("background-color",jt),window.removeEventListener("scroll",qt))},refresh(){return n=this,i=void 0,o=function*(){if(!("spine_threejs"in E.pageAssetConfig))return;if(!Ft){Ft=!0,function(){const t=window.innerWidth,e=window.innerHeight;Pt=new THREE.PerspectiveCamera(75,t/e,1,3e3),Pt.position.y=100,Pt.position.z=500,At.push({obj:Pt,animation:wt,finish:!1})}(),Tt=new THREE.Scene,St=new THREE.WebGLRenderer,$t=St.domElement,function(){const t=new THREE.PlaneGeometry(2048,1024),e=new THREE.MeshBasicMaterial,n=new THREE.TextureLoader;e.map=n.load(Ct+"index_room.jpg");const i=new THREE.Mesh(t,e);i.position.set(0,185,-95),Tt.add(i)}(),It=new spine.AssetManager(Ct);for(const t of Et)It.loadText(t.skeletonFile),It.loadTextureAtlas(t.atlasFile),yield It.loadAll(),Dt(t)}zt=!0,Lt.forEach((e=>{const n=t.randomInt(0,kt.length);e.state.setAnimation(0,kt[n],!0)})),e.assert("header").insertAdjacentElement("afterbegin",$t);const n=e.assert(".banner-mask");jt=n.css("background-color"),n.css("background-color","rgba(0, 0, 0, 0.1)"),window.addEventListener("scroll",qt),requestAnimationFrame(Rt)},new((s=void 0)||(s=Promise))((function(t,e){function a(t){try{c(o.next(t))}catch(t){e(t)}}function r(t){try{c(o.throw(t))}catch(t){e(t)}}function c(e){var n;e.done?t(e.value):(n=e.value,n instanceof s?n:new s((function(t){t(n)}))).then(a,r)}c((o=o.apply(n,i||[])).next())}));var n,i,s,o}}];var fe=function(t,e,n,i){return new(n||(n=Promise))((function(s,o){function a(t){try{c(i.next(t))}catch(t){o(t)}}function r(t){try{c(i.throw(t))}catch(t){o(t)}}function c(t){var e;t.done?s(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(a,r)}c((i=i.apply(t,e||[])).next())}))};v.initialize(),document.addEventListener("DOMContentLoaded",(()=>fe(void 0,void 0,void 0,(function*(){yield E.initializeAsync();const e=E.siteConfig.loading_box;W.initialize(e.enable,e.image_src),W.display(.45,"initializing site..."),yield _.registerComponentsAsync(...me),G.initialize(E.siteConfig.pjax.enable,E.siteConfig.pjax.options,(()=>{W.display(.45,"changing page..."),_.cleanupAllComponents()}),(()=>{!function(){fe(this,void 0,void 0,(function*(){W.display(.7,"loading assets...");const e=Object.values(E.pageAssetConfig).flat();yield a.loadAssetsAsync(e),W.display(.94,"refreshing..."),yield _.refreshAllComponentsAsync(),W.display(1,"success"),t.scrollTo(0,!1)}))}()}))}))))})()})();